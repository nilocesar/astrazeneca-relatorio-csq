$(document).ready(function(){intRelatorio(),$("#dwnldBtn").on("click",async()=>{var t=new ExcelJS.Workbook;let a=t.addWorksheet("Planilha1");var e=document.getElementById("dataTable");function r(t){return"number"==typeof t?t.toString():t}var l=e.querySelectorAll("thead th"),l=Array.from(l).slice(0,-1).map(t=>{let e=t.innerHTML.replace(/<br\s*\/?>/g,"\n");return r(e=e.replace(/<small>(.*?)<\/small>/g,"$1"))}),l=a.addRow(l);l.height=30,l.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"8a034f"}},t.font={bold:!0,color:{argb:"FFFFFF"}},t.alignment={horizontal:"center",vertical:"middle",wrapText:!0},t.border={top:{style:"thin",color:{argb:"ffffff"}},left:{style:"thin",color:{argb:"ffffff"}},bottom:{style:"thin",color:{argb:"ffffff"}},right:{style:"thin",color:{argb:"ffffff"}}},t.numFmt="@"});e.querySelectorAll("tbody tr").forEach((t,e)=>{t=Array.from(t.querySelectorAll("td")).slice(0,-1).map(t=>{let e=t.innerHTML.replace(/<br\s*\/?>/g,"\n");return r(e=e.replace(/<small>(.*?)<\/small>/g,"$1"))}),t=a.addRow(t);t.height=20,t.eachCell(t=>{t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"f2e5ec"}},e%2==0&&(t.fill={type:"pattern",pattern:"solid",fgColor:{argb:"f9f2f5"}}),t.alignment={horizontal:"center",vertical:"middle",wrapText:!0},t.border={top:{style:"thin",color:{argb:"8a034f"}},left:{style:"thin",color:{argb:"8a034f"}},bottom:{style:"thin",color:{argb:"8a034f"}},right:{style:"thin",color:{argb:"8a034f"}}},isNaN(t.value)||(console.log(t.value),t.value=String(t.value),t.numFmt="@")})}),a.columns.forEach((t,e)=>{t.width=1===e||2===e?40:15});l=await t.xlsx.writeBuffer(),e=new Blob([l],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),t=document.createElement("a");t.href=URL.createObjectURL(e),t.download=`relatorio_${Date.now()}.xlsx`,t.click()})});const intRelatorio=()=>{$(".preloader").removeClass("hide"),$("#pop1").css("display","none"),setTimeout(()=>{bridge.listRankingDB(t=>{controlRanking(t),$(".preloader").addClass("hide")})},2e3)},letraFiltro=t=>{return["A","B","C","D","E"][t-1]};function segundosParaHora(t){var e=Math.floor(t/3600),a=Math.floor(t%3600/60),t=t%60;return`${String(e).padStart(2,"0")}:${String(a).padStart(2,"0")}:`+String(t).padStart(2,"0")}const controlRanking=e=>{$("#dataTable tbody").empty(),e.map((t,e)=>($("#dataTable tbody").append(`<tr class="it it${e}" indice=${e} name=${t.data.name} email=${t.data.email}>
								<td>${e+1<10?"0":""}${String(e+1)}</td>
								<td>${t.data.nome||t.data.name}</td>
								<td>${t.data.email}</td>
								<td>${Number(t.data.point)}</td>
                <td>${Number(t.data.time||0)}s</td>
                <td class="deletarBtn" indice=${e} name=${t.data.name} email=${t.data.email}><span>Deletar</span></td>
							</tr>`),t));var a=null;$(".deletarBtn").on("click",function(){a=$(this),$("#pop1").css("display","flex"),$("#pop1").find("span").html(a.attr("name"))}),$("#cancel").on("click",function(){$("#pop1").css("display","none")}),$("#confirmClearBd").on("click",function(){$("#pop1").css("display","none");var t={...e[a.attr("indice")].data};$(".preloader").removeClass("hide"),bridge.handlerControlStatusUser(t,()=>{intRelatorio()})})};
//# sourceMappingURL=script.js.map
