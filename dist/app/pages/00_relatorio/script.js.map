{"version":3,"sources":["script.js"],"names":["$","document","ready","intRelatorio","on","async","let","worksheet","workbook","addWorksheet","table","getElementById","convertToString","value","toString","headers","cleanText","querySelectorAll","replace","slice","map","th","innerHTML","header","headerRow","type","addRow","pattern","fgColor","cell","argb","color","bold","horizontal","vertical","alignment","wrapText","left","style","border","top","forEach","row","rowIndex","Array","from","td","bottom","excelRow","rowData","height","eachCell","numFmt","fill","isNaN","console","log","String","columns","column","index","buffer","await","xlsx","writeBuffer","blob","Blob","link","createElement","href","URL","createObjectURL","download","Date","now","click","removeClass","right","setTimeout","bridge","listRankingDB","results","controlRanking","addClass","letraFiltro","indice","segundosParaHora","segundos","floor","minutos","Math","segundosRestantes","padStart","empty","item","append","data","name","email","Number","point","currentItem","this","css","find","html","attr","letra","handlerControlStatusUser"],"mappings":"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","file":"script.js","sourcesContent":["$(document).ready(function () {\n  intRelatorio();\n\n  $(\"#dwnldBtn\").on(\"click\", async () => {\n    // Clona a tabela sem afetar a original\n\n    let workbook = new ExcelJS.Workbook();\n    let worksheet = workbook.addWorksheet(\"Planilha1\");\n\n    let table = document.getElementById(\"dataTable\");\n\n    // Função para garantir que números sejam convertidos em strings\n    function convertToString(value) {\n      return typeof value === \"number\" ? value.toString() : value;\n    }\n\n    // Pega o cabeçalho, remove <br>, <small>, converte números para string e remove a última coluna\n    let headers = table.querySelectorAll(\"thead th\");\n    let headerRow = Array.from(headers)\n      .slice(0, -1)\n      .map((th) => {\n        let cleanText = th.innerHTML.replace(/<br\\s*\\/?>/g, \"\\n\"); // Substitui <br> por nova linha\n        cleanText = cleanText.replace(/<small>(.*?)<\\/small>/g, \"$1\"); // Remove <small> e mantém o texto\n        return convertToString(cleanText); // Converte para string\n      });\n\n    // Adiciona cabeçalho ao Excel com estilo\n    let header = worksheet.addRow(headerRow);\n    header.height = 30;\n    header.eachCell((cell) => {\n      cell.fill = {\n        type: \"pattern\",\n        pattern: \"solid\",\n        fgColor: { argb: \"8a034f\" },\n      };\n      cell.font = { bold: true, color: { argb: \"FFFFFF\" } }; // Texto branco e negrito\n      cell.alignment = {\n        horizontal: \"center\",\n        vertical: \"middle\",\n        wrapText: true,\n      }; // Centraliza e permite quebra de linha\n      cell.border = {\n        top: { style: \"thin\", color: { argb: \"ffffff\" } },\n        left: { style: \"thin\", color: { argb: \"ffffff\" } },\n        bottom: { style: \"thin\", color: { argb: \"ffffff\" } },\n        right: { style: \"thin\", color: { argb: \"ffffff\" } },\n      }; // Adiciona borda preta\n      cell.numFmt = \"@\"; // Formato como texto no Excel\n    });\n\n    // Pega as linhas, converte <br> em nova linha, remove <small>, converte números para string e remove a última coluna\n    let rows = table.querySelectorAll(\"tbody tr\");\n    rows.forEach((row, rowIndex) => {\n      let rowData = Array.from(row.querySelectorAll(\"td\"))\n        .slice(0, -1)\n        .map((td) => {\n          let cleanText = td.innerHTML.replace(/<br\\s*\\/?>/g, \"\\n\"); // Substitui <br> por nova linha\n          cleanText = cleanText.replace(/<small>(.*?)<\\/small>/g, \"$1\"); // Remove <small> e mantém o texto\n          return convertToString(cleanText); // Converte para string\n        });\n      let excelRow = worksheet.addRow(rowData);\n      excelRow.height = 20;\n\n      excelRow.eachCell((cell) => {\n        cell.fill = {\n          type: \"pattern\",\n          pattern: \"solid\",\n          fgColor: { argb: \"f2e5ec\" },\n        };\n\n        if (rowIndex % 2 === 0) {\n          cell.fill = {\n            type: \"pattern\",\n            pattern: \"solid\",\n            fgColor: { argb: \"f9f2f5\" },\n          };\n        }\n\n        cell.alignment = {\n          horizontal: \"center\",\n          vertical: \"middle\",\n          wrapText: true,\n        }; // Centraliza e permite quebra de linha\n        cell.border = {\n          top: { style: \"thin\", color: { argb: \"8a034f\" } },\n          left: { style: \"thin\", color: { argb: \"8a034f\" } },\n          bottom: { style: \"thin\", color: { argb: \"8a034f\" } },\n          right: { style: \"thin\", color: { argb: \"8a034f\" } },\n        }; // Adiciona borda preta\n        if (!isNaN(cell.value)) {\n          console.log(cell.value);\n          cell.value = String(cell.value);\n          cell.numFmt = \"@\"; // Formato como texto no Excel\n        }\n      });\n    });\n\n    // Ajusta largura das colunas automaticamente e define larguras personalizadas para a 2ª e 3ª colunas\n    worksheet.columns.forEach((column, index) => {\n      if (index === 1) {\n        // 2ª coluna\n        column.width = 40; // Largura personalizada para a 2ª coluna\n      } else if (index === 2) {\n        // 3ª coluna\n        column.width = 40; // Largura personalizada para a 3ª coluna\n      } else {\n        column.width = 15; // Largura padrão para outras colunas\n      }\n    });\n\n    // Salva o arquivo\n    let buffer = await workbook.xlsx.writeBuffer();\n    let blob = new Blob([buffer], {\n      type: \"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet\",\n    });\n    let link = document.createElement(\"a\");\n    link.href = URL.createObjectURL(blob);\n    link.download = `relatorio_${Date.now()}.xlsx`;\n    link.click();\n  });\n});\n\nconst intRelatorio = () => {\n  $(\".preloader\").removeClass(\"hide\");\n  $(\"#pop1\").css(\"display\", \"none\");\n  setTimeout(() => {\n    bridge.listRankingDB((results) => {\n      // console.log(results);\n      controlRanking(results);\n      $(\".preloader\").addClass(\"hide\");\n    });\n  }, 1000 * 2);\n};\n\nconst letraFiltro = (indice) => {\n  const letra = [\"A\", \"B\", \"C\", \"D\", \"E\"];\n  return letra[indice - 1];\n};\n\nfunction segundosParaHora(segundos) {\n  const horas = Math.floor(segundos / 3600);\n  const minutos = Math.floor((segundos % 3600) / 60);\n  const segundosRestantes = segundos % 60;\n\n  return `${String(horas).padStart(2, \"0\")}:${String(minutos).padStart(\n    2,\n    \"0\"\n  )}:${String(segundosRestantes).padStart(2, \"0\")}`;\n}\n\nconst controlRanking = (results) => {\n  $(\"#dataTable tbody\").empty();\n  results.map((item, indice) => {\n    $(\"#dataTable tbody\")\n      .append(`<tr class=\"it it${indice}\" indice=${indice} name=${\n      item.data.name\n    } email=${item.data.email}>\n\t\t\t\t\t\t\t\t<td>${indice + 1 < 10 ? \"0\" : \"\"}${String(indice + 1)}</td>\n\t\t\t\t\t\t\t\t<td>${item.data.nome || item.data.name}</td>\n\t\t\t\t\t\t\t\t<td>${item.data.email}</td>\n\t\t\t\t\t\t\t\t<td>${Number(item.data.point)}</td>\n                <td class=\"deletarBtn\" indice=${indice} name=${\n      item.data.name\n    } email=${item.data.email}><span>${\"Deletar\"}</span></td>\n\t\t\t\t\t\t\t</tr>`);\n\n    return item;\n  });\n\n  var currentItem = null;\n  $(\".deletarBtn\").on(\"click\", function () {\n    currentItem = $(this);\n    $(\"#pop1\").css(\"display\", \"flex\");\n    $(\"#pop1\").find(\"span\").html(currentItem.attr(\"name\"));\n  });\n\n  $(\"#cancel\").on(\"click\", function () {\n    $(\"#pop1\").css(\"display\", \"none\");\n  });\n\n  $(\"#confirmClearBd\").on(\"click\", function () {\n    $(\"#pop1\").css(\"display\", \"none\");\n    const item = results[currentItem.attr(\"indice\")].data;\n\n    // console.log(item);\n\n    const data = { ...item };\n\n    $(\".preloader\").removeClass(\"hide\");\n    bridge.handlerControlStatusUser(data, () => {\n      intRelatorio();\n    });\n  });\n};\n"]}